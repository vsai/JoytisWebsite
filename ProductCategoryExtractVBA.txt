Sub CreateProductCategories()    Worksheets("Product Categories").Activate    Dim i As Long    lastcell = Range("A" & Cells.Rows.Count).End(xlUp).Row    Dim category As String    Dim subCategories As String    category = Range("A1").Value        Dim j As Integer    Dim rng As Range    Dim s As String    For i = 1 To lastcell        Set rng = Range("A" & i)        If rng.Value <> "" Then            'Reached a new Category            Debug.Print category & ": " & subCategories            category = rng.Value            subCategories = ""            s = ""            For j = 1 To 3                s = rng.Offset(0, j).Value                If (s <> "") Then                    subCategories = subCategories & ", " & s                End If            Next j        ElseIf category <> "" Then            'Category cell is empty, so check if we have ever had a category            s = ""            For j = 1 To 3                s = rng.Offset(0, j).Value                If (s <> "") Then                    subCategories = subCategories & ", " & s                End If            Next j        End If    Next i    End Sub